[✨ Located in SF Bay Area or LA? Get free Revit AI automation consulting from YC-backed AI engineers →](https://archilabs.ai/ca-revit-ai-pilot)



#### ConvertToStableRepresentation Method

---



|  |
| --- |
| [Reference Class](d28155ae-817b-1f31-9c3f-c9c6a28acc0d.htm)   [Example](#exampleToggle)   [See Also](#seeAlsoToggle) |

Converts the reference to a stable String representation.

**Namespace:**   [Autodesk.Revit.DB](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm)    
  **Assembly:**   RevitAPI  (in RevitAPI.dll) Version: 17.0.0.0 (17.0.1090.0)

# Syntax

| C# |
| --- |
| ``` public string ConvertToStableRepresentation( 	Document document ) ``` |

 

| Visual Basic |
| --- |
| ``` Public Function ConvertToStableRepresentation ( _ 	document As Document _ ) As String ``` |

 

| Visual C++ |
| --- |
| ``` public: String^ ConvertToStableRepresentation( 	Document^ document ) ``` |

#### Parameters

document
:   Type:  [Autodesk.Revit.DB Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.htm)    
     The document.

# Remarks

The stable representation can be used to preserve and restore the reference later in the same Revit session or even in a different session where the same document is present. Use  [ParseFromStableRepresentation(Document, String)](dc168535-2688-83da-429f-a2d018ff4b43.htm)  to restore the reference. The representation is based on the internal Revit structure and is not intended to be parsed expect by  [ParseFromStableRepresentation(Document, String)](dc168535-2688-83da-429f-a2d018ff4b43.htm)  .

# Examples

![](https://d24b2zsrnzhmgb.cloudfront.net/static/img/chm/icons/CopyCode.gif) Copy  C#

```
public string SerializeReference(Document doc, Reference reference)
{
    String ids = String.Empty;
    ids = reference.ConvertToStableRepresentation(doc);
    TaskDialog.Show("SerializeReference", "Representation:\n" + ids);
    return ids;
}
```

 

![](https://d24b2zsrnzhmgb.cloudfront.net/static/img/chm/icons/CopyCode.gif) Copy  VB.NET

```
Public Function SerializeReference(doc As Document, reference As Reference) As String
    Dim ids As [String] = [String].Empty
    ids = reference.ConvertToStableRepresentation(doc)
    TaskDialog.Show("SerializeReference", "Representation:" & vbLf + ids)
    Return ids
End Function
```

# Exceptions

| Exception | Condition |
| --- | --- |
| [Autodesk.Revit.Exceptions ArgumentNullException](631e1424-60f4-929b-4e52-dda9dcd26316.htm) | document was    a null reference (  Nothing  in Visual Basic)  . |
| [Autodesk.Revit.Exceptions InvalidObjectException](8092dec2-113a-0823-1a09-a46c11f99fea.htm) | Reference contained element ids not found in this document. |

# See Also

[Reference Class](d28155ae-817b-1f31-9c3f-c9c6a28acc0d.htm)

[Autodesk.Revit.DB Namespace](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm)