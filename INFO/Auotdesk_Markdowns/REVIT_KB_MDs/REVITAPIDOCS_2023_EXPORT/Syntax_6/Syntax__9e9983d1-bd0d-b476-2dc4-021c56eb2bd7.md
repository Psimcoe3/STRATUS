[✨ Located in SF Bay Area or LA? Get free Revit AI automation consulting from YC-backed AI engineers →](https://archilabs.ai/ca-revit-ai-pilot)



#### Commit Method (FailureHandlingOptions)

---



|  |
| --- |
| [Transaction Class](308ebf8d-d96d-4643-cd1d-34fffcea53fd.htm)   [Example](#exampleToggle)   [See Also](#seeAlsoToggle) |

Commits all changes made to the model during the transaction.

**Namespace:**   [Autodesk.Revit.DB](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm)    
  **Assembly:**   RevitAPI  (in RevitAPI.dll) Version: 22.0.0.0 (22.1.0.0)

# Syntax

| C# |
| --- |
| ``` public TransactionStatus Commit( 	FailureHandlingOptions options ) ``` |

 

| Visual Basic |
| --- |
| ``` Public Function Commit ( _ 	options As FailureHandlingOptions _ ) As TransactionStatus ``` |

 

| Visual C++ |
| --- |
| ``` public: TransactionStatus Commit( 	FailureHandlingOptions^ options ) ``` |

#### Parameters

options
:   Type:  [Autodesk.Revit.DB FailureHandlingOptions](c03bb2e5-f679-bf24-4e87-08b3c3a08385.htm)    
     A set of  [options](c03bb2e5-f679-bf24-4e87-08b3c3a08385.htm)  to be used for handling eventual failures during this call.

    The options are only used temporarily during the commitment process. After the transaction is finished, the options will be reset to their default values.

#### Return Value

If finished successfully, this method returns TransactionStatus.Committed

Note it is possible the RolledBack status is returned instead as an outcome of failure handling. If TransactionStatus.Pending is returned it means that failure handling has not been finalized yet and Revit awaits user's actions. Until committing is fully finalized, no changes to the document can be made (including starting of new transactions).

Be aware that the returned status does not have to be necessarily the same like the status returned by  [GetStatus](fdf98941-eee4-d8af-e3f7-5b6c7ccc3c74.htm)  even when the method is called immediately after committing the transaction. Such difference may happen due to actions made by a transaction finalizer, if there was one set. (See  [FailureHandlingOptions](c03bb2e5-f679-bf24-4e87-08b3c3a08385.htm)  for more details.)

# Examples

![](https://d24b2zsrnzhmgb.cloudfront.net/static/img/chm/icons/CopyCode.gif) Copy  C#

```
// All and any transaction should be enclosed in a 'using'
// block or guarded within a try-catch-finally blocks
// to guarantee that a transaction does not out-live its scope.
using (Transaction transaction = new Transaction(document))
{
   // Must start the transaction first to be able to modify a document
   transaction.Start("Creating Level");

   if (null != Level.Create(document, elevation))
   {
      // If we have a few transactions chained (for whatever reason)
      // we may wish to collect eventual warnings, if any, and show
      // them only when the last transaction of the chain is committed.
      FailureHandlingOptions options = transaction.GetFailureHandlingOptions();

      // Now, showing of any eventual mini-warnings will be
      // postponed until the following transaction.
      transaction.Commit(options.SetDelayedMiniWarnings(true));

      // Note, after a transaction is committed, the used failure options
      // are lost and replaced with default options again.
   }
}
```

 

![](https://d24b2zsrnzhmgb.cloudfront.net/static/img/chm/icons/CopyCode.gif) Copy  VB.NET

```
' All and any transaction should be enclosed in a 'using'
' block or guarded within a try-catch-finally blocks
' to guarantee that a transaction does not out-live its scope.
Using transaction As New Transaction(document)
    ' Must start the transaction first to be able to modify a document
    transaction.Start("Creating Level")

If Level.Create(document, elevation) IsNot Nothing Then
   ' If we have a few transactions chained (for whatever reason)
   ' we may wish to collect eventual warnings, if any, and show
   ' them only when the last transaction of the chain is committed.
   Dim options As FailureHandlingOptions = transaction.GetFailureHandlingOptions()

   ' Now, showing of any eventual mini-warnings will be
   ' postponed until the following transaction.


   ' Note, after a transaction is committed, the used failure options
   ' are lost and replaced with default options again.
   transaction.Commit(options.SetDelayedMiniWarnings(True))
End If
End Using
```

# Exceptions

| Exception | Condition |
| --- | --- |
| [Autodesk.Revit.Exceptions ArgumentNullException](631e1424-60f4-929b-4e52-dda9dcd26316.htm) | A non-optional argument was null |
| [Autodesk.Revit.Exceptions InvalidOperationException](9e715f03-3884-e539-4dd6-8d7545733adc.htm) | Document is a linked file. Transactions can only be used in primary documents (projects or families.) -or- The current status of the transaction is not 'Started'. Transaction must be started before calling Commit or Rollback. -or- The transaction's document is currently in failure mode. No transaction operations are permitted until failure handling is finished. |

# See Also

[Transaction Class](308ebf8d-d96d-4643-cd1d-34fffcea53fd.htm)

[Commit Overload](bb7917ec-9fc7-b0a8-e3b7-2b38015cbc08.htm)

[Autodesk.Revit.DB Namespace](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm)