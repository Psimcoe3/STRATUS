[✨ Located in SF Bay Area or LA? Get free Revit AI automation consulting from YC-backed AI engineers →](https://archilabs.ai/ca-revit-ai-pilot)



#### RequestSystemsAnalysis Method

---



|  |
| --- |
| [ViewSystemsAnalysisReport Class](a7b5b7de-dfdb-e57f-7fac-1ff1dbf35e4d.htm)   [Example](#exampleToggle)   [See Also](#seeAlsoToggle) |

Requests a new systems analysis in the background.

**Namespace:**   [Autodesk.Revit.DB.Analysis](958e2e12-587d-f188-5d7b-f13d7dbfdf48.htm)    
  **Assembly:**   RevitAPI  (in RevitAPI.dll) Version: 22.0.0.0 (22.1.0.0)   
  **Since:**  2020.1

# Syntax

| C# |
| --- |
| ``` public void RequestSystemsAnalysis( 	SystemsAnalysisOptions options ) ``` |

 

| Visual Basic |
| --- |
| ``` Public Sub RequestSystemsAnalysis ( _ 	options As SystemsAnalysisOptions _ ) ``` |

 

| Visual C++ |
| --- |
| ``` public: void RequestSystemsAnalysis( 	SystemsAnalysisOptions^ options ) ``` |

#### Parameters

options
:   Type:  [Autodesk.Revit.DB.Analysis SystemsAnalysisOptions](8d8fe6a8-d3f6-c4fd-99ac-3181ba0253d6.htm)    
     The additional options to run systems analysis. If empty, use the default value in the view element. The request may download the weather file at current site location if not specified in the options.

# Examples

![](https://d24b2zsrnzhmgb.cloudfront.net/static/img/chm/icons/CopyCode.gif) Copy  C#

```
// Create a new report and request systems analysis on the current energy model.
ViewSystemsAnalysisReport newReport = null;

SystemsAnalysisOptions theOptions = new SystemsAnalysisOptions();
string openStudioPath = Path.GetFullPath(Path.Combine(doc.Application.SystemsAnalysisWorkfilesRootPath, @"..\"));
// The following are the default values for systems analysis if not specified.
// If the weather file is not specified, the analysis will use the weather at the current site location.
theOptions.WorkflowFile = Path.Combine(openStudioPath, @"workflows\HVAC Systems Loads and Sizing.osw");
theOptions.OutputFolder = Path.GetTempPath();
using (Transaction transaction = new Transaction(doc))
{
   transaction.Start("Create Systems Analysis View");

   newReport = ViewSystemsAnalysisReport.Create(doc, "APITestView");
   // Create a new report of systems analysis. 
   if (newReport != null)
   {
      newReport.RequestSystemsAnalysis(theOptions);
      // Request the systems analysis in the background process. When the systems analysis is completed, 
      // the result is automatically updated in the report view and the analytical space elements.
      // You may check the status by calling newReport.IsAnalysisCompleted().
      transaction.Commit();
   }
   else
   {
      transaction.RollBack();
   }
}
```

 

![](https://d24b2zsrnzhmgb.cloudfront.net/static/img/chm/icons/CopyCode.gif) Copy  VB.NET

```
' Create a New report And request systems analysis on the current energy model.
Dim newReport As ViewSystemsAnalysisReport = Nothing

Dim theOptions As SystemsAnalysisOptions = New SystemsAnalysisOptions()
Dim openStudioPath As String = Path.GetFullPath(Path.Combine(doc.Application.SystemsAnalysisWorkfilesRootPath, "..\"))
' The following are the default values for systems analysis if not specified.
' If the weather file is not specified, the analysis will use the weather at the current site location.
theOptions.WorkflowFile = Path.Combine(openStudioPath, "workflows\HVAC Systems Loads and Sizing.osw")
theOptions.OutputFolder = Path.GetTempPath()
Using t As New Transaction(doc, "Create Systems Analysis View")
   t.Start()

   newReport = ViewSystemsAnalysisReport.Create(doc, "APITestView")
   ' Create a new report of systems analysis. 
   If newReport IsNot Nothing Then
      newReport.RequestSystemsAnalysis(theOptions)
      ' Request the systems analysis in the background process. When the systems analysis Is completed, 
      ' the result Is automatically updated in the report view And the analytical space elements.
      ' You may check the status by calling newReport.IsAnalysisCompleted().
      t.Commit()
   Else
      t.RollBack()
   End If
End Using
```

# Exceptions

| Exception | Condition |
| --- | --- |
| [Autodesk.Revit.Exceptions ArgumentNullException](631e1424-60f4-929b-4e52-dda9dcd26316.htm) | A non-optional argument was null |
| [Autodesk.Revit.Exceptions ArgumentsInconsistentException](05972c68-fa6d-3a83-d720-ad84fbc4780f.htm) | No weather station is within 500 nautical miles of this site location. |
| [Autodesk.Revit.Exceptions FileNotFoundException](73250198-dbc6-e760-4297-ec062f00f574.htm) | Fail to download the weather file. |
| [Autodesk.Revit.Exceptions InvalidOperationException](9e715f03-3884-e539-4dd6-8d7545733adc.htm) | A valid energy model is required for systems analysis. -or- Unable to access the weather service. Try again later. |

# See Also

[ViewSystemsAnalysisReport Class](a7b5b7de-dfdb-e57f-7fac-1ff1dbf35e4d.htm)

[Autodesk.Revit.DB.Analysis Namespace](958e2e12-587d-f188-5d7b-f13d7dbfdf48.htm)